if(typeof jQuery==="undefined"){throw new Error("jQueryPlus requires jQuery")}!function($){String.prototype.contains=function(str){return this.indexOf(str)>-1};String.prototype.trim=function(){return $.trim(this)};String.prototype.replaceAll=function(s1,s2){return this.replace(new RegExp(s1,"gm"),s2)};String.prototype.cnLength=function(){var realLength=0,len=this.length,charCode=-1;for(var i=0;i<len;i++){charCode=this.charCodeAt(i);if(charCode>=0&&charCode<=128){realLength+=1}else{realLength+=2}}return realLength};String.prototype.escapeDangerStr=function(){var value=this;value=value.replace(/</g,"&lt;");value=value.replace(/>/g,"&gt;");value=value.replace(/'/g,"&#39;");value=value.replace(/\"/g,"&quot;");return value};window.StringUtils={validate:function(value,validType){function validateLength(value,validType){if(typeof value=="number"){value=value+""}var length=(value||"").cnLength();var param=validType.substring("length[".length,validType.length-1).split(",");var min=parseInt(param.length==2?param[0]:-1);var max=parseInt(param.length==1?param[0]:param[1]);var validateMin=min>-1;var validateMax=max>-1;var msg=null;if(validateMin&&validateMax){if(length<min||length>max){msg=sprintf("文本长度不能小于%s字，超过%s字",NumberUtils.toFixed(min/2),parseInt(max/2))}}else{if(validateMax){if(length>max){msg=sprintf("文本长度不能超过%s字",parseInt(max/2))}}else{if(validateMin){if(length<min){msg=sprintf("文本长度不能小于%s字",NumberUtils.toFixed(min/2))}}}}return{isValid:msg==null,msg:msg}}function validateCharLength(value,validType){if(typeof value=="number"){value=value+""}var length=(value||"").length;var param=validType.substring("charLength[".length,validType.length-1).split(",");var min=parseInt(param.length==2?param[0]:-1);var max=parseInt(param.length==1?param[0]:param[1]);var validateMin=min>-1;var validateMax=max>-1;var msg=null;if(validateMin&&validateMax){if(length<min||length>max){msg=sprintf("文本长度不能小于%s字，超过%s字",min,max)}}else{if(validateMax){if(length>max){msg=sprintf("文本长度不能超过%s字",max)}}else{if(validateMin){if(length<min){msg=sprintf("文本长度不能小于%s字",min)}}}}return{isValid:msg==null,msg:msg}}function validateReg(value,reg,msg){if(reg.test(value)){return{isValid:true}}else{return{isValid:false,msg:msg}}}function validateIdCard(value){var errMsg="身份证号码格式错误";var valid=function(sId){var iSum=0;var info="";if(!/^\d{17}(\d|x)$/i.test(sId)&&!/^\d{15}$/i.test(sId)){return errMsg}sId=sId.replace(/x$/i,"a");if(aCity[parseInt(sId.substr(0,2))]==null){return errMsg}switch(sId.length){case 15:var sBirthday="19"+sId.substr(6,2)+"-"+Number(sId.substr(8,2))+"-"+Number(sId.substr(10,2));var d=new Date(sBirthday.replace(/-/g,"/"));if(sBirthday!=(d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate())){return errMsg}break;case 18:var sBirthday=sId.substr(6,4)+"-"+Number(sId.substr(10,2))+"-"+Number(sId.substr(12,2));var d=new Date(sBirthday.replace(/-/g,"/"));if(sBirthday!=(d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate())){return errMsg}for(var i=17;i>=0;i--){iSum+=(Math.pow(2,i)%11)*parseInt(sId.charAt(17-i),11)}if(iSum%11!=1){return errMsg}break}return true};var aCity={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};var tip=valid(value);return{isValid:tip===true,msg:tip}}var result={isValid:true};if(validType.indexOf("length[")>-1){result=validateLength(value,validType)}else{if(validType.indexOf("charLength[")>-1){result=validateCharLength(value,validType)}else{if("idCard"==validType){result=validateIdCard(value)}else{if("phone"==validType){result=validateReg(value,/^(13|14|15|16|17|18|19)\d{9}$/i,"不是正确的手机号码")}else{if("intlPhone"==validType){var intlPhoneRex=/^00\d{2}\d*$/i;var phoneRex=/^(13|14|15|16|17|18|19)\d{9}$/i;if(intlPhoneRex.test(value)||phoneRex.test(value)){result={isValid:true}}else{result={isValid:false,msg:"不正确的手机号码"}}}else{if("postcode"==validType){result=validateReg(value,/^[0-9]\d{5}$/i,"不是有效的邮政编码")}else{if("email"==validType){result=validateReg(value,/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,"不是有效的电子邮件地址");if(result.isValid&&value.length>60){result={isValid:false,msg:"邮箱长度不能大于60位"}}}else{if("url"==validType){result=validateReg(value,/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,"不是有效的URL地址")}else{if("password"==validType){result={isValid:false,msg:"8-20位且同时包含大写字母、小写字母和数字"};if(value.length<8||value.length>20){return result}if(/[^a-zA-Z0-9]+/.test(value)){return result}var cnt=0;if(/([a-z])+/.test(value)){cnt++}if(/([A-Z])+/.test(value)){cnt++}if(/([0-9])+/.test(value)){cnt++}if(cnt>=3){result={isValid:true}}}else{if("enhancedPassword"==validType){result={isValid:false,msg:"10-20位且同时包含大小写字母、数字和特殊字符"};if(value.length<10||value.length>20){return result}if(/[^a-zA-Z0-9`~!@#$%^&*()_+\-={}|\[\]\\:";'<>?,.\/]+/.test(value)){return result}var cnt=0;if(/([a-z])+/.test(value)){cnt++}if(/([A-Z])+/.test(value)){cnt++}if(/([0-9])+/.test(value)){cnt++}if(/([`~!@#$%^&*()_+\-={}|\[\]\\:";'<>?,.\/]+)/.test(value)){cnt++}if(cnt>=4){result={isValid:true}}}else{if("tel"==validType){result=validateReg(value,/^((\d{3,4}\-)|)\d{7,8}(|([-\u8f6c]{1}\d{1,5}))$/,"请输入正确的固定电话号码，如:[0531-]888888(7-8位)[转888]")}else{if("qq"==validType){result=validateReg(value,/^[1-9]\d{4,19}$/,"请输入正确的QQ号码，5-20位的数字")}else{if(validType.indexOf("fn")==0){var fnName=validType.substring(3,validType.length-1);result=$.util.exec(fnName,[value])}else{if(validType.indexOf("ajax")==0){var url=validType.substring(5,validType.length-1);url=new Url(url,"value",value||"");result=$.req(url,false)}else{if("letter"==validType){result=validateReg(value,/^[A-Za-z]+$/,"只允许输入字母")}else{if("number"==validType){result=validateReg(value,/^[0-9]*$/,"只允许输入数字")}else{if("weixin"==validType){result=validateReg(value,/^[a-zA-Z]{1}[-_a-zA-Z0-9]{5,29}$/,"请按照微信账号的格式输入，以字母开头的6-30位字母、数字、下划线或减号")}else{if("half-width"==validType){result=validateReg(value,/^[^\uff00-\uffff]*$/,"请输入非全角的字符串")}}}}}}}}}}}}}}}}}}return result},escapeHtml:function(text){return this.replaceToHtmlCharacterEntities(text)},replaceToHtmlCharacterEntities:function(text){if(typeof text==="string"){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/\"/g,"&quot;")}return text}};Array.prototype.indexOf=function(value){for(var i=0;i<this.length;i++){if(this[i]==value){return i}}return -1};Array.prototype.contains=function(value){return this.indexOf(value)!=-1};Array.prototype.remove=function(value,index){if(typeof index=="undefined"){index=this.indexOf(value)}if(index>-1){this.splice(index,1)}};Array.prototype.filter=function(fun){return $.grep(this,fun)};Array.prototype.each=function(fun){$.each(this,fun)};Date.prototype.addMilliseconds=function(value){var millisecond=this.getMilliseconds();this.setMilliseconds(millisecond+value);return this};Date.prototype.addSeconds=function(value){var second=this.getSeconds();this.setSeconds(second+value);return this};Date.prototype.addMinutes=function(value){var minute=this.addMinutes();this.setMinutes(minute+value);return this};Date.prototype.addHours=function(value){var hour=this.getHours();this.setHours(hour+value);return this};Date.prototype.addDays=function(value){var date=this.getDate();this.setDate(date+value);return this};Date.prototype.addWeeks=function(value){return this.addDays(value*7)};Date.prototype.addMonths=function(value){var month=this.getMonth();this.setMonth(month+value);return this};Date.prototype.addYears=function(value){var year=this.getFullYear();this.setFullYear(year+value);return this};Date.prototype.format=function(format){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(format)){format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(format)){format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return format};window.DatetimeUtils={formatJsonDate:function(dateStr,mask){return this.format(this.parse(dateStr),mask)},format:function(date,mask){var dateStr=date;if(date&&(date instanceof Date)){dateStr=mask;dateStr=dateStr.replace("yyyy",this._padding(date.getFullYear()));dateStr=dateStr.replace("MM",this._padding(date.getMonth()+1));dateStr=dateStr.replace("dd",this._padding(date.getDate()));dateStr=dateStr.replace("HH",this._padding(date.getHours()));dateStr=dateStr.replace("mm",this._padding(date.getMinutes()));dateStr=dateStr.replace("ss",this._padding(date.getSeconds()))}return dateStr},parse:function(s,mask){function getNum(m){var num=(m=="dd"||m=="MM")?1:0;var start=mask.indexOf(m);if(start>-1){var end=start+m.length;num=end<=s.length?new Number(s.substring(start,end)):num}return isNaN(num)?0:num}if(s){if(s instanceof Date){return s}if(typeof s=="number"||!isNaN(s)||!mask){s+="";mask="yyyyMMddHHmmss"}var y=getNum("yyyy");var m=getNum("MM");var d=getNum("dd");var h=getNum("HH");var mm=getNum("mm");var ss=getNum("ss");if(typeof y!="undefined"&&typeof m!="undefined"&&typeof d!="undefined"){s=new Date(y,m-1,d,h,mm,ss)}}return s},_padding:function(value){value=isNaN(value)?0:value;return(value<10?"0":"")+value}};window.NumberUtils={toFixed:function(value,d){var s=value+"";if(!d){d=0}if(s.indexOf(".")==-1){s+="."}s+=new Array(d+1).join("0");if(new RegExp("^(-|\\+)?(\\d+(\\.\\d{0,"+(d+1)+"})?)\\d*$").test(s)){var s="0"+RegExp.$2,pm=RegExp.$1,a=RegExp.$3.length,b=true;if(a==d+2){a=s.match(/\d/g);if(parseInt(a[a.length-1])>4){for(var i=a.length-2;i>=0;i--){a[i]=parseInt(a[i])+1;if(a[i]==10){a[i]=0;b=i!=1}else{break}}}s=a.join("").replace(new RegExp("(\\d+)(\\d{"+d+"})\\d$"),"$1.$2")}if(b){s=s.substr(1)}return(pm+s).replace(/\.$/,"")}return value+""},format:function(value){if(value==null){return""}var s1=value,s2="";var _1b=value.indexOf(".");if(_1b>=0){s1=value.substring(0,_1b);s2=value.substring(_1b+1,value.length)}var p=/(\d+)(\d{3})/;while(p.test(s1)){s1=s1.replace(p,"$1,$2")}if(s2){return s1+"."+s2}else{return s1}}};window.HtmlTag=function(tagName){this.tagName=tagName||"";this.attrMap={};this.childTags=[];this.beforeTags=[];this.afterTags=[];this.styles=[];this.classes=[];return this};var proxy={},index=0;HtmlTag.setProxyValue=function(value){var key="data_"+(index++);proxy[key]=value;return key};HtmlTag.getProxyValue=function(key,keep){var value=proxy[key];if(!keep){delete proxy[key]}return value};HtmlTag.hasProxyData=function(){return !$.isEmptyObject(proxy)};window.createTag=function(tagName){return new HtmlTag(tagName)};window.PinyinUtils={getPinyin:function(chinese){if(!window.pinyinUtil){throw new Error("PinyinUtils requires pinyin")}return pinyinUtil.getPinyin(chinese).toUpperCase()}};window.sprintf=function(str){var args=arguments,flag=true,i=1;str=str.replace(/%s/g,function(){var arg=args[i++];if(typeof arg==="undefined"){flag=false;return""}return arg});return flag?str:""};HtmlTag.prototype.setName=function(name){this.tagName=name;return this};HtmlTag.prototype.isEmpty=function(){return !(this.beforeTags.length||this.childTags.length||this.afterTags.length)};HtmlTag.prototype.attr=function(name,value){if(name&&(value!=undefined&&value!=null)){switch(name.toLowerCase()){case"style":this.css(name,value);break;case"class":this.addClass(value);break;default:this.attrMap[name]=value;break}}return this};HtmlTag.ATTRS=["margin","padding","text-indent","flex-basis"];HtmlTag.KEYS=["width","height","size","left","right","top","bottom"];HtmlTag.prototype.css=function(name,value){if(name){if(value!=undefined&&value!=null){if(typeof value=="number"&&isPxAttrValue(name)){value+="px"}name=name+":"+value}else{if(name.indexOf(":")<0){return this}}this.styles.push(name)}return this};function isPxAttrValue(attrName){if(HtmlTag.ATTRS.contains(attrName)){return true}var attrArr=attrName.split("-");for(var i=0;i<HtmlTag.KEYS.length;i++){if(attrArr.contains(HtmlTag.KEYS[i])){return true}}return false}HtmlTag.prototype.addClass=function(value,prefix){if(value){var isAdd=true;if(typeof prefix=="string"){value=prefix+value}else{if(typeof prefix=="boolean"){isAdd=prefix}}if(isAdd){this.classes.push(value)}}return this};HtmlTag.prototype.removeClass=function(value){this.classes.remove(value);return this};HtmlTag.prototype.append=function(tag){if(tag!=null){this.childTags.push(tag)}return this};HtmlTag.prototype.appendTo=function(tag){if(tag!=null&&tag instanceof HtmlTag){tag.append(this)}return this};HtmlTag.prototype.prepend=function(tag){if(tag!=null){this.childTags.unshift(tag)}return this};HtmlTag.prototype.prependTo=function(tag){if(tag!=null&&tag instanceof HtmlTag){tag.prepend(this)}return this};HtmlTag.prototype.after=function(tag){if(tag!=null){this.afterTags.push(tag)}return this};HtmlTag.prototype.before=function(tag){if(tag!=null){this.beforeTags.push(tag)}return this};HtmlTag.prototype.insertAfter=function(tag){if(tag!=null&&tag instanceof HtmlTag){tag.after(this)}return this};HtmlTag.prototype.insertBefore=function(tag){if(tag!=null&&tag instanceof HtmlTag){tag.before(this)}return this};HtmlTag.prototype.data=function(name,value){if(name){name=name.replace(/([A-Z])/g,"-$1").toLowerCase();if(value&&(typeof value=="object"||typeof value=="function")){value=HtmlTag.setProxyValue(value);name+="_proxy"}this.attr("data-"+name,value)}return this};HtmlTag.prototype.toString=function(){var html="";for(var i=0;i<this.beforeTags.length;i++){var tag=this.beforeTags[i];html+=tag instanceof HtmlTag?tag.toString():tag}if(this.tagName){this.tagName=this.tagName.escapeDangerStr();html+="<"+this.tagName;if(this.styles.length>0){var stylesStr=this.styles.join(";");html+=' style="'+stylesStr.escapeDangerStr()+'"'}if(this.classes.length>0){var classesStr=this.classes.join(" ");html+=' class="'+classesStr.escapeDangerStr()+'"'}for(var key in this.attrMap){key=key.escapeDangerStr();var value=this.attrMap[key];if(typeof value==="boolean"){if(key.indexOf("data-")>-1){html+=(" "+key+'="'+value+'"')}else{if(value){html+=" "+key}}}else{value=value.toString().escapeDangerStr();html+=" "+key;html+='="'+value+'"'}}html+=">"}for(var i=0;i<this.childTags.length;i++){var tag=this.childTags[i];html+=tag instanceof HtmlTag?tag.toString():tag}if(this.tagName&&!["input","link","base","meta","img"].contains(this.tagName.toLowerCase())){html+="</"+this.tagName+">"}for(var i=0;i<this.afterTags.length;i++){var tag=this.afterTags[i];html+=tag instanceof HtmlTag?tag.toString():tag}return html};if($.browser){return}$.browser={};$.browser.mozilla=false;$.browser.webkit=false;$.browser.opera=false;$.browser.msie=false;var nAgt=navigator.userAgent;$.browser.name=navigator.appName;$.browser.version=""+parseFloat(navigator.appVersion);$.browser.majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;if((verOffset=nAgt.indexOf("Opera"))!=-1){$.browser.opera=true;$.browser.name="Opera";$.browser.version=nAgt.substring(verOffset+6);if((verOffset=nAgt.indexOf("Version"))!=-1){$.browser.version=nAgt.substring(verOffset+8)}}else{if((verOffset=nAgt.indexOf("MSIE"))!=-1||nAgt.indexOf("rv:11.0")!=-1){$.browser.msie=true;$.browser.name="Microsoft Internet Explorer";$.browser.version=nAgt.substring(verOffset+5)}else{if((verOffset=nAgt.indexOf("Chrome"))!=-1){$.browser.webkit=true;$.browser.name="Chrome";$.browser.version=nAgt.substring(verOffset+7)}else{if((verOffset=nAgt.indexOf("Safari"))!=-1){$.browser.webkit=true;$.browser.name="Safari";$.browser.version=nAgt.substring(verOffset+7);if((verOffset=nAgt.indexOf("Version"))!=-1){$.browser.version=nAgt.substring(verOffset+8)}}else{if((verOffset=nAgt.indexOf("Firefox"))!=-1){$.browser.mozilla=true;$.browser.name="Firefox";$.browser.version=nAgt.substring(verOffset+8)}else{if((nameOffset=nAgt.lastIndexOf(" ")+1)<(verOffset=nAgt.lastIndexOf("/"))){$.browser.name=nAgt.substring(nameOffset,verOffset);$.browser.version=nAgt.substring(verOffset+1);if($.browser.name.toLowerCase()==$.browser.name.toUpperCase()){$.browser.name=navigator.appName}}}}}}}if((ix=$.browser.version.indexOf(";"))!=-1){$.browser.version=$.browser.version.substring(0,ix)}if((ix=$.browser.version.indexOf(" "))!=-1){$.browser.version=$.browser.version.substring(0,ix)}$.browser.majorVersion=parseInt(""+$.browser.version,10);if(isNaN($.browser.majorVersion)){$.browser.version=""+parseFloat(navigator.appVersion);$.browser.majorVersion=parseInt(navigator.appVersion,10)}$.browser.version=$.browser.majorVersion;$.browser.isRestrictMsie=function(version){return $.browser.msie&&$.browser.version<=version};$.util={addSource:function(src){var isJS=src.lastIndexOf(".js")>-1;var selector=src.replace(/\./g,"\\.").replace(/\//g,"\\/").replace(/\:/g,"\\:");if(isJS){if($("script[src="+selector+"]").length==0){$("body").append("<script type='text/javascript' src='"+src+"'/>")}}else{if($("link[href="+selector+"]").length==0){$("head").append("<link rel='stylesheet' type='text/css' href='"+src+"'>")}}},getText:function(text){if(arguments.length>1){for(var i=1;i<arguments.length;i++){text=text.replace("{"+(i-1)+"}",arguments[i])}}return text},getBaseUrl:function(){return $("base").attr("href")},exec:function(name,args,options){if(!name){return}var func=name;if(typeof name==="string"){name=name.trim();var names=name.split(".");if(name.charAt(name.length-1)==")"){if(names.length==1){var index=name.indexOf("(");if(index){var fnName=name.substring(0,index);name=$.pageProxy.util.findFnProxy(fnName,options.pageProxy)+name}}return eval(name)}if(names.length>1){func=eval(name)}else{func=$.pageProxy.util.findFn(name,options.pageProxy)}}if(!$.isFunction(func)){throw new Error(sprintf("函数%s未定义",name?"["+name+"]":""))}return func.apply(options.context,args||[])},supportFlash:function(){var support=false;var flashVersion=0;try{if(document.all){var swf=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(swf){support=true;VSwf=swf.GetVariable("$version");flashVersion=parseInt(VSwf.split(" ")[1].split(",")[0])}}else{if(navigator.plugins&&navigator.plugins.length>0){var swf=navigator.plugins["Shockwave Flash"];if(swf){support=true;var words=swf.description.split(" ");for(var i=0;i<words.length;++i){if(isNaN(parseInt(words[i]))){continue}flashVersion=parseInt(words[i])}}}}}catch(e){}return support},transListToTree:function(list,options){options=$.extend({idField:"id",parentField:"parent"},options);var idField=options.idField,parentField=options.parentField,childrenField="children";var dataMap={};for(var i=0;i<list.length;i++){var data=list[i];dataMap[data[idField]]=data}var treeList=[];for(var i=0;i<list.length;i++){var data=list[i];var parent=dataMap[data[parentField]];if(parent){var children=parent[childrenField];if(!children){children=[];parent[childrenField]=children}children.push(data)}else{treeList.push(data)}}return treeList},getUrlParam:function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null){return unescape(r[2])}return null},setCookie:function(key,value,options){var path=getCookiePath();options=$.extend({},{path:path,expires:30},options);if(typeof value=="object"){value=JSON.stringify(value)}$.cookie(key,value,options)},getCookie:function(key){var val=$.cookie(key);val=$.req.formatData(val);return val}};function getCookiePath(){var baseUrl=$.util.getBaseUrl();var urls=baseUrl.split("/");var path="/";if(urls.length>3){path+=(urls[3]||"")}return path}window.Url=function(url,param1,param2){if(!url){throw new Error("Url Exception: url不能为空")}if(url instanceof Url){this.urlStr=url.urlStr;this.params=url.params;this.formIds=url.formIds;this.objectParams=url.objectParams}else{this.urlStr=url;this.params={};this.formIds=[];this.objectParams={}}if(param1){this.addParam(param1,param2)}};Url.prototype.getUrl=function(){var url=this.urlStr;if(!$.isEmptyObject(this.params)){url+=url.indexOf("?")>-1?"":"?";url+=$.param(this.getSerializeParams())}return url};Url.prototype.addParam=function(key,value){if(!key){throw new Error("Url Exception: 参数名称key不能为空")}if($.isPlainObject(key)){for(var k in key){this.params[k]=key[k]}}else{this.params[key]=value}};Url.prototype.addObjectParam=function(key,value){if(!key){throw new Error("Url Exception: 参数名称key不能为空")}this.objectParams[key]=value};Url.prototype.addForm=function(key){if(!key){throw new Error("Url Exception: 参数名称key不能为空")}this.formIds.push(key);var value=get(key).getData();this.params[key]=value};Url.prototype.getSerializeParams=function(){var params={};for(var key in this.params){var value=this.params[key];params[key]=value&&typeof value=="object"?JSON.stringify(value):value}for(var key in this.objectParams){var value=this.objectParams[key];params[key]=value}return params};$.req=function(options,onLoadSuccess){if(!options){throw new Error("url不能为空")}options=$.isPlainObject(options)?options:{url:options};options.onLoadSuccess=options.onLoadSuccess||options.success;var url=new Url(options.url);var param=url.params;var result=$.util.exec(options.onBeforeLoad,[param],options);if(result!==false){if($.isFunction(onLoadSuccess)){options.onLoadSuccess=onLoadSuccess}else{if(typeof onLoadSuccess==="boolean"){options.async=onLoadSuccess}}var errorHandler=function(result){if(result.type=="sessionout"){$.alert({title:result.msg,type:"warning",buttons:[{text:"重新登录",onClick:function(){var loginUrl=result.loginUrl;var redirectURL=encodeURI(location.href);loginUrl+=((loginUrl.indexOf("?")==-1?"?":"&")+"redirectUrl="+redirectURL);location.href=loginUrl}}]})}else{$.util.exec(options.onLoadError||$.req.defaults.onLoadError,[result],{context:options});$.util.exec(options.afterLoadError,[result],{context:options})}};var options=$.extend({},$.req.defaults,options,{success:function(data){options.$modal&&$.hideLoad(options.$modal);data=$.req.formatData(data);if($.isPlainObject(data)&&data.success===false){errorHandler(data)}else{$.util.exec(options.onLoadSuccess,[data],options)}},error:function(XMLHttpRequest,textStatus,errorThrown){options.$modal&&$.hideLoad(options.$modal);var result=$.req.formatData(XMLHttpRequest.responseText);result=typeof result=="string"?{type:XMLHttpRequest.status,data:result}:result;errorHandler(result)},complete:function(){$.util.exec(options.onComplete,null,options)}});if(options.type=="POST"){options.url=url.urlStr;if(!options.data){options.data=url.getSerializeParams()}}else{options.url=url.getUrl()}if(options.async&&options.modal){options.$modal=$.load(options.loadingText)}var token=$._getToken();if(token){options.headers=$.extend(options.headers,{Authorization:"Bearer "+token})}$.util.exec(options.onLoading,null,options);var result=$.ajax(options);if(!options.async){result=$.req.formatData(result.responseText);if(!($.isPlainObject(result)&&result.success===false)){return result}}return result}};$.req.formatData=function(data){if(typeof data=="string"){try{var obj=$.parseJSON(data);var type=typeof obj;switch(type){case"object":case"boolean":data=obj;break;default:break}}catch(e){}}return data};$.download=function(options,onLoadSuccess){if(!options){throw new Error("url不能为空")}options=$.isPlainObject(options)?options:{url:options};var url=new Url(options.url);if($.util.isMobile){window.open(url.getUrl());return}url.addParam("_download","true");if($._getToken()){url.addParam("token",$._getToken())}if($.isFunction(onLoadSuccess)){options.onLoadSuccess=onLoadSuccess}var modal=$.load("下载中。。。");$.fileDownload($.util.getBaseUrl()+url.urlStr,{httpMethod:"POST",data:url.getSerializeParams(),successCallback:function(){$.hideLoad(modal);$.util.exec(options.onLoadSuccess,[],{context:options})},failCallback:function(result,url){$.hideLoad(modal);result=$.req.formatData(result);if(result.type=="sessionout"){$.alert({title:result.msg,type:"warning",buttons:[{text:"重新登录",onClick:function(){var loginUrl=result.loginUrl;var redirectURL=encodeURI(location.href);loginUrl+=((loginUrl.indexOf("?")==-1?"?":"&")+"redirectUrl="+redirectURL);location.href=loginUrl}}]})}else{if(options.onLoadError){$.util.exec(options.onLoadError,[result],{context:options})}else{var msg=result.msg;if(!msg){msg="请求["+url+"]出错"}$.notify({title:msg,type:"warning",timeOut:10000});if(result.type!="bizex"&&console){console.error("请求 %s 出错",url);console.error(result)}}}}})};$.downloadLink=function(url,fileName){$.alert("文件开始下载，请耐心等待。。。");fileName=fileName||"未知文件";var el=document.createElement("a");el.style.display="none";el.setAttribute("target","_blank");fileName&&el.setAttribute("download",fileName);el.href=url;document.body.appendChild(el);el.click();document.body.removeChild(el)};$._getToken=function(){var token=$.req.token;if(!token){token=getCookie("Admin-Token");$.req.token=token}return token};$._setToken=function(token){$.req.token=token};function getCookie(name){var cookies=document.cookie.split("; ");for(var i=0;i<cookies.length;i++){var cookie=cookies[i].split("=");if(cookie[0]===name){return cookie[1]}}return""}window.AliPayUtils={pay:function(options){if(!options.url){throw new Error("url不能为空")}var content="<p>请在新打开的支付平台完成支付</p>";var buttons=options.buttons||[];if(options.onPayFail){buttons.push({text:"支付遇到问题",onClick:function(){$.closeDialog();this.exec(options.onPayFail)}})}buttons.push({text:"支付完成",onClick:function(){$.closeDialog();this.exec(options.onPaySuccess)}});$.openDialog({title:"支付结果",width:400,content:content,closeBtn:false,headerCloseBtn:false,buttons:buttons});var url=new Url(options.url);window.open(url.getUrl(),"_blank")}};window.PayUtils={pay:function(options){window.AliPayUtils.pay(options)}}}(window.jQuery);(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(g){var f=this.prototype;a=true;var e=new this();a=false;if(g){for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}}function c(){if(!a&&this.init){this.init.apply(this,arguments)}}c.prototype=e;c.prototype.constructor=c;c.extend=arguments.callee;return c};if(window.navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)){$.util.isMobile=true}else{$.util.isMobile=false}window.StorageUtils={set:function(c,d){localStorage.setItem(c,JSON.stringify(d))},get:function(c){return JSON.parse(localStorage.getItem(c))},remove:function(c){localStorage.removeItem(c)}}})();!function(a){a(function(){var b=a.req("sysCommon/getEzConfig",false);for(var c in b){if(typeof c==="string"){window[c]=b[c]}}a._setToken(b.token)})}(window.jQuery);