!function(g){g.extend(g.fn.bootstrapTable.defaults,{treeShowField:null,idField:"id",parentIdField:"parent",onGetNodes:function(k,j){var i=this;var h=[];h=k.children||[];return h},onCheckRoot:function(j,i){var h=this;return !j[h.options.parentIdField]}});var b=g.fn.bootstrapTable.Constructor,a=b.prototype.initRow,f=b.prototype.initHeader,d=b.prototype.initBody,c=b.prototype.updateRow;b.prototype.initHeader=function(){var i=this;f.apply(i,Array.prototype.slice.apply(arguments));var h=i.options.treeShowField;if(h){g.each(this.header.fields,function(j,k){if(h===k){i.treeData={};i.treeEnable=true;return false}})}};var e=function(s,r,m,l){var p=this;var h=p.options.onGetNodes.apply(p,[s,m]);s._nodes=h;r=l.length;l.push(a.apply(p,[s,r,m,l]));p.treeData[s[p.options.idField]?s[p.options.idField]:0]=s;var q=h.length-1;for(var n=0;n<=q;n++){var k=h[n];k._level=s._level+1;k._parent=s;if(n===q){k._last=1}var j=k[p.options.idField]?k[p.options.idField]:0;var o=k[p.options.parentIdField]?k[p.options.parentIdField]:0;k._class="treegrid-"+j+" treegrid-parent-"+o;e.apply(p,[k,r+n,m,l])}};b.prototype.initRow=function(k,i,l,m){var j=this;if(j.treeEnable){if(k._level===undefined){k._level=0}var h=k[j.options.idField]?k[j.options.idField]:0;k._class="treegrid-"+h;e.apply(j,[k,i,l,m]);return true}return a.apply(j,Array.prototype.slice.apply(arguments))};b.prototype.initBody=function(){var i=this;if(i.treeEnable){if(!i.options.treeData){this.options.data=g.util.transListToTree(this.options.data,{idField:this.options.idField,textField:this.options.textField,parentField:this.options.parentField})}d.apply(this,Array.prototype.slice.apply(arguments));this.$selectItem=(this.$fixedBody||this.$body).find(sprintf('[name="%s"]',this.options.selectItemName));var h=(this.$fixedBody||this.$body).find(".box-control");g.fn.checkbox.util.init(h);h.off("checked").on("checked",function(m,l){m.stopImmediatePropagation();var o=g(this).find(":checkbox"),n=o.closest("tr").data("uniqueid"),q=i.treeData[n];if(g(this).is(":radio")||i.options.singleSelect){g.each(i.options.data,function(r,s){s[i.header.stateField]=false})}q[i.header.stateField]=l;if(i.options.singleSelect){i.$selectItem.not(this).each(function(){i.data[g(this).data("index")][i.header.stateField]=false});i.$selectItem.filter(":checked").not(this).prop("checked",false)}var j=function(r){i.$body.find(".treegrid-parent-"+r).each(function(){var s=g(this).data("uniqueid");k(s);j(s)})};var p=function(t){if(t){var u=i.treeData[t];if(!l){var s=u.children;for(var r=0;r<s.length;r++){if(s[r][i.header.stateField]){return}}}k(t);p(u[i.options.parentIdField])}};var k=function(s){var r=i.$selectItem.filter(sprintf('[value="%s"]',s)).prop("checked",l);i.treeData[s][i.header.stateField]=l};j(n);p(q[i.options.parentIdField]);i.updateSelected();i.trigger(l?"check":"uncheck",q,o)});this.$body.off("click dblclick").on("click dblclick","> tr[data-index] > td",function(p){var j=g(this),l=j.parent(),s=i.treeData[l.data("uniqueid")],n=j[0].cellIndex,m=i.getVisibleFields(),q=m[i.options.detailView&&!i.options.cardView?n-1:n],k=i.columns[i.fieldsColumnsIndex[q]],r=g.fn.bootstrapTable.utils.getItemField(s,q,i.options.escape);if(j.find(".detail-icon").length){return}i.trigger(p.type==="click"?"click-cell":"dbl-click-cell",q,r,s,j,p);i.trigger(p.type==="click"?"click-row":"dbl-click-row",s,l,q,p);if(p.type==="click"&&i.options.clickToSelect&&k.clickToSelect&&i.options.ignoreClickToSelectOn(p.target)){var o=l.find(sprintf('[name="%s"]',i.options.selectItemName));if(o.length){o[0].click()}}})}else{d.apply(this,Array.prototype.slice.apply(arguments))}};b.prototype.getAllSelections=function(){var i=this;if(i.treeEnable){var h=[];var j=function(l){for(var k=0;k<l.length;k++){var m=l[k];if(m[i.header.stateField]===true){h.push(m);m.children&&j(m.children)}}};j(this.options.data);return h}else{return g.grep(this.options.data,function(k){return k[i.header.stateField]===true})}};b.prototype.updateRows=function(){var h=this;if(h.treeEnable){this.$selectItem.each(function(){h.treeData[g(this).attr("value")][h.header.stateField]=g(this).prop("checked")})}else{this.$selectItem.each(function(){h.data[g(this).closest("tr").data("index")][h.header.stateField]=g(this).prop("checked")})}};b.prototype.updateRow=function(l){if(this.treeEnable){if(!l.hasOwnProperty("index")||!l.hasOwnProperty("row")){return}var h=this.$body.find("tr:eq("+l.index+")");if(h.length){var n=h.treegrid("getNodeId");if(n==null){return}var k=l.row;delete k[this.options.idField];delete k[this.options.parentIdField];l.row=g.extend(this.treeData[n],k);var i=g(a.apply(this,[l.row,l.index]));var j=i.find('[data-field="'+this.options.textField+'"]');var m=h.find('[data-field="'+this.options.textField+'"]');if(j.length&&m.length){m.find(".tree-title").html(j.html());j.replaceWith(m.clone(true))}h.empty().append(i.children())}}else{c.apply(this,[l])}}}(jQuery);