/*!
 * Viewer.js v1.3.5
 * https://fengyuanchen.github.io/viewerjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2019-07-04T11:00:16.790Z
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b=b||self,b.Viewer=a())}(this,function(){function z(bN){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){z=function(bO){return typeof bO}}else{z=function(bO){return bO&&typeof Symbol==="function"&&bO.constructor===Symbol&&bO!==Symbol.prototype?"symbol":typeof bO}}return z(bN)}function aw(bN,bO){if(!(bN instanceof bO)){throw new TypeError("Cannot call a class as a function")}}function bz(bQ,bO){for(var bN=0;bN<bO.length;bN++){var bP=bO[bN];bP.enumerable=bP.enumerable||false;bP.configurable=true;if("value" in bP){bP.writable=true}Object.defineProperty(bQ,bP.key,bP)}}function aZ(bP,bN,bO){if(bN){bz(bP.prototype,bN)}if(bO){bz(bP,bO)}return bP}var N={backdrop:true,button:true,navbar:true,title:true,toolbar:true,className:"",container:"body",filter:null,fullscreen:true,initialViewIndex:0,inline:false,interval:5000,keyboard:true,loading:true,loop:true,minWidth:200,minHeight:100,movable:true,zoomable:true,playable:false,rotatable:true,scalable:true,toggleOnDblclick:true,tooltip:true,transition:true,zIndex:2015,zIndexInline:0,zoomRatio:0.1,minZoomRatio:0.01,maxZoomRatio:100,url:"src",ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null,zoom:null,zoomed:null};var ae='<div class="viewer-container" touch-action="none"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><div class="viewer-toolbar"></div><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div role="button" class="viewer-button" data-viewer-action="mix"></div><div class="viewer-player"></div></div>';var d=typeof window!=="undefined";var an=d?window:{};var H=d?"ontouchstart" in an.document.documentElement:false;var bo=d?"PointerEvent" in an:false;var G="viewer";var bw="move";var aj="switch";var y="zoom";var ay="".concat(G,"-active");var bA="".concat(G,"-close");var c="".concat(G,"-fade");var bH="".concat(G,"-fixed");var bt="".concat(G,"-fullscreen");var bn="".concat(G,"-fullscreen-exit");var ac="".concat(G,"-hide");var bG="".concat(G,"-hide-md-down");var h="".concat(G,"-hide-sm-down");var aB="".concat(G,"-hide-xs-down");var J="".concat(G,"-in");var ab="".concat(G,"-invisible");var bi="".concat(G,"-loading");var bL="".concat(G,"-move");var A="".concat(G,"-open");var T="".concat(G,"-show");var bp="".concat(G,"-transition");var s="click";var bB="dblclick";var I="dragstart";var a9="hidden";var at="hide";var a="keydown";var aC="load";var be=H?"touchstart":"mousedown";var ba=H?"touchmove":"mousemove";var C=H?"touchend touchcancel":"mouseup";var bl=bo?"pointerdown":be;var br=bo?"pointermove":ba;var bC=bo?"pointerup pointercancel":C;var ad="ready";var ar="resize";var ai="show";var k="shown";var aQ="transitionend";var Z="view";var bD="viewed";var aF="wheel";var af="zoom";var az="zoomed";var bg="".concat(G,"Action");var B=/\s\s*/;var n=["zoom-in","zoom-out","one-to-one","reset","prev","play","next","rotate-left","rotate-right","flip-horizontal","flip-vertical"];var bb=["放大","缩小","原始尺寸","重置","上一张","播放","下一张","向左旋转","向右旋转","左右翻转","上下翻转"];function bf(bN){return typeof bN==="string"}var aA=Number.isNaN||an.isNaN;function V(bN){return typeof bN==="number"&&!aA(bN)}function aJ(bN){return typeof bN==="undefined"}function bJ(bN){return z(bN)==="object"&&bN!==null}var D=Object.prototype.hasOwnProperty;function o(bP){if(!bJ(bP)){return false}try{var bQ=bP.constructor;var bO=bQ.prototype;return bQ&&bO&&D.call(bO,"isPrototypeOf")}catch(bN){return false}}function j(bN){return typeof bN==="function"}function ag(bP,bQ){if(bP&&j(bQ)){if(Array.isArray(bP)||V(bP.length)){var bO=bP.length;var bN;for(bN=0;bN<bO;bN+=1){if(bQ.call(bP,bP[bN],bN,bP)===false){break}}}else{if(bJ(bP)){Object.keys(bP).forEach(function(bR){bQ.call(bP,bP[bR],bR,bP)})}}}return bP}var W=Object.assign||function W(bQ){for(var bN=arguments.length,bO=new Array(bN>1?bN-1:0),bP=1;bP<bN;bP++){bO[bP-1]=arguments[bP]}if(bJ(bQ)&&bO.length>0){bO.forEach(function(bR){if(bJ(bR)){Object.keys(bR).forEach(function(bS){bQ[bS]=bR[bS]})}})}return bQ};var e=/^(?:width|height|left|top|marginLeft|marginTop)$/;function M(bN,bP){var bO=bN.style;ag(bP,function(bR,bQ){if(e.test(bQ)&&V(bR)){bR+="px"}bO[bQ]=bR})}function K(bN){return bf(bN)?bN.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):bN}function r(bN,bO){return bN.classList?bN.classList.contains(bO):bN.className.indexOf(bO)>-1}function q(bN,bP){if(!bP){return}if(V(bN.length)){ag(bN,function(bQ){q(bQ,bP)});return}if(bN.classList){bN.classList.add(bP);return}var bO=bN.className.trim();if(!bO){bN.className=bP}else{if(bO.indexOf(bP)<0){bN.className="".concat(bO," ").concat(bP)}}}function aU(bN,bO){if(!bO){return}if(V(bN.length)){ag(bN,function(bP){aU(bP,bO)});return}if(bN.classList){bN.classList.remove(bO);return}if(bN.className.indexOf(bO)>=0){bN.className=bN.className.replace(bO,"")}}function aS(bN,bP,bO){if(!bP){return}if(V(bN.length)){ag(bN,function(bQ){aS(bQ,bP,bO)});return}if(bO){q(bN,bP)}else{aU(bN,bP)}}var a0=/([a-z\d])([A-Z])/g;function bs(bN){return bN.replace(a0,"$1-$2").toLowerCase()}function a5(bO,bN){if(bJ(bO[bN])){return bO[bN]}if(bO.dataset){return bO.dataset[bN]}return bO.getAttribute("data-".concat(bs(bN)))}function ak(bO,bN,bP){if(bJ(bP)){bO[bN]=bP}else{if(bO.dataset){bO.dataset[bN]=bP}else{bO.setAttribute("data-".concat(bs(bN)),bP)}}}var aE=function(){var bN=false;if(d){var bQ=false;var bR=function bR(){};var bP=Object.defineProperty({},"once",{get:function bO(){bN=true;return bQ},set:function bS(bT){bQ=bT}});an.addEventListener("test",bR,bP);an.removeEventListener("test",bR,bP)}return bN}();function f(bO,bQ,bR){var bN=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var bP=bR;bQ.trim().split(B).forEach(function(bT){if(!aE){var bS=bO.listeners;if(bS&&bS[bT]&&bS[bT][bR]){bP=bS[bT][bR];delete bS[bT][bR];if(Object.keys(bS[bT]).length===0){delete bS[bT]}if(Object.keys(bS).length===0){delete bO.listeners}}}bO.removeEventListener(bT,bP,bN)})}function bk(bP,bQ,bR){var bO=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var bN=bR;bQ.trim().split(B).forEach(function(bV){if(bO.once&&!aE){var bS=bP.listeners,bU=bS===void 0?{}:bS;bN=function bT(){delete bU[bV][bR];bP.removeEventListener(bV,bN,bO);for(var bW=arguments.length,bY=new Array(bW),bX=0;bX<bW;bX++){bY[bX]=arguments[bX]}bR.apply(bP,bY)};if(!bU[bV]){bU[bV]={}}if(bU[bV][bR]){bP.removeEventListener(bV,bU[bV][bR],bO)}bU[bV][bR]=bN;bP.listeners=bU}bP.addEventListener(bV,bN,bO)})}function aL(bN,bO,bQ){var bP;if(j(Event)&&j(CustomEvent)){bP=new CustomEvent(bO,{detail:bQ,bubbles:true,cancelable:true})}else{bP=document.createEvent("CustomEvent");bP.initCustomEvent(bO,true,true,bQ)}return bN.dispatchEvent(bP)}function bI(bN){var bO=bN.getBoundingClientRect();return{left:bO.left+(window.pageXOffset-document.documentElement.clientLeft),top:bO.top+(window.pageYOffset-document.documentElement.clientTop)}}function E(bS){var bR=bS.rotate,bQ=bS.scaleX,bO=bS.scaleY,bU=bS.translateX,bT=bS.translateY;var bN=[];if(V(bU)&&bU!==0){bN.push("translateX(".concat(bU,"px)"))}if(V(bT)&&bT!==0){bN.push("translateY(".concat(bT,"px)"))}if(V(bR)&&bR!==0){bN.push("rotate(".concat(bR,"deg)"))}if(V(bQ)&&bQ!==1){bN.push("scaleX(".concat(bQ,")"))}if(V(bO)&&bO!==1){bN.push("scaleY(".concat(bO,")"))}var bP=bN.length?bN.join(" "):"none";return{WebkitTransform:bP,msTransform:bP,transform:bP}}function bF(bN){return bf(bN)?decodeURIComponent(bN.replace(/^.*\//,"").replace(/[?&#].*$/,"")):""}var by=an.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(an.navigator.userAgent);function aX(bO,bQ){var bP=document.createElement("img");if(bO.naturalWidth&&!by){bQ(bO.naturalWidth,bO.naturalHeight);return bP}var bN=document.body||document.documentElement;bP.onload=function(){bQ(bP.width,bP.height);if(!by){bN.removeChild(bP)}};bP.src=bO.src;if(!by){bP.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;";bN.appendChild(bP)}return bP}function R(bN){switch(bN){case 2:return aB;case 3:return h;case 4:return bG;default:return""}}function a4(bN){var bP=W({},bN);var bO=[];ag(bN,function(bR,bQ){delete bP[bQ];ag(bP,function(bS){var bU=Math.abs(bR.startX-bS.startX);var bX=Math.abs(bR.startY-bS.startY);var bT=Math.abs(bR.endX-bS.endX);var bV=Math.abs(bR.endY-bS.endY);var bZ=Math.sqrt(bU*bU+bX*bX);var bY=Math.sqrt(bT*bT+bV*bV);var bW=(bY-bZ)/bZ;bO.push(bW)})});bO.sort(function(bR,bQ){return Math.abs(bR)<Math.abs(bQ)});return bO[0]}function au(bR,bQ){var bP=bR.pageX,bO=bR.pageY;var bN={endX:bP,endY:bO};return bQ?bN:W({timeStamp:Date.now(),startX:bP,startY:bO},bN)}function bj(bN){var bP=0;var bO=0;var bQ=0;ag(bN,function(bT){var bS=bT.startX,bR=bT.startY;bP+=bS;bO+=bR;bQ+=1});bP/=bQ;bO/=bQ;return{pageX:bP,pageY:bO}}var Q={render:function Q(){this.initContainer();this.initViewer();this.initList();this.renderViewer()},initContainer:function bh(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function aH(){var bN=this.options,bO=this.parent;var bP;if(bN.inline){bP={width:Math.max(bO.offsetWidth,bN.minWidth),height:Math.max(bO.offsetHeight,bN.minHeight)};this.parentData=bP}if(this.fulled||!bP){bP=this.containerData}this.viewerData=W({},bP)},renderViewer:function a7(){if(this.options.inline&&!this.fulled){M(this.viewer,this.viewerData)}},initList:function bm(){var bR=this;var bP=this.element,bO=this.options,bQ=this.list;var bN=[];ag(this.images,function(bX,bU){var bY=bX.src;var bW=K(bX.alt||bF(bY));var bT=bO.url;if(bf(bT)){bT=bX.getAttribute(bT)}else{if(j(bT)){bT=bT.call(bR,bX)}}if(bY||bT){var bV=document.createElement("li");var bS=document.createElement("img");bS.src=bT||bY;bS.alt=bW;bS.setAttribute("data-index",bU);bS.setAttribute("data-original-url",bT||bY);bS.setAttribute("data-viewer-action","view");bS.setAttribute("role","button");bV.appendChild(bS);bQ.appendChild(bV);bN.push(bV)}});this.items=bN;ag(bN,function(bS){var bT=bS.firstElementChild;ak(bT,"filled",true);if(bO.loading){q(bS,bi)}bk(bT,aC,function(bU){if(bO.loading){aU(bS,bi)}bR.loadImage(bU)},{once:true})});if(bO.transition){bk(bP,bD,function(){q(bQ,bp)},{once:true})}},renderList:function L(bN){var bO=bN||this.index;var bP=this.items[bO].offsetWidth||30;var bQ=bP+1;M(this.list,W({width:bQ*this.length},E({translateX:(this.viewerData.width-bP)/2-bQ*bO})))},resetList:function aY(){var bN=this.list;bN.innerHTML="";aU(bN,bp);M(bN,E({translateX:0}))},initImage:function bx(bS){var bV=this;var bX=this.options,bR=this.image,bN=this.viewerData;var bW=this.footer.offsetHeight;var bP=bN.width;var bU=Math.max(bN.height-bW,bW);var bO=this.imageData||{};var bQ;this.imageInitializing={abort:function bT(){bQ.onload=null}};bQ=aX(bR,function(b0,b3){var b2=b0/b3;var b1=bP;var bZ=bU;bV.imageInitializing=false;if(bU*b2>bP){bZ=bP/b2}else{b1=bU*b2}b1=Math.min(b1*0.9,b0);bZ=Math.min(bZ*0.9,b3);var b4={naturalWidth:b0,naturalHeight:b3,aspectRatio:b2,ratio:b1/b0,width:b1,height:bZ,left:(bP-b1)/2,top:(bU-bZ)/2};var bY=W({},b4);if(bX.rotatable){b4.rotate=bO.rotate||0;bY.rotate=0}if(bX.scalable){b4.scaleX=bO.scaleX||1;b4.scaleY=bO.scaleY||1;bY.scaleX=1;bY.scaleY=1}bV.imageData=b4;bV.initialImageData=bY;if(bS){bS()}})},renderImage:function bv(bN){var bP=this;var bQ=this.image,bS=this.imageData;M(bQ,W({width:bS.width,height:bS.height,marginLeft:bS.left,marginTop:bS.top},E(bS)));if(bN){if((this.viewing||this.zooming)&&this.options.transition){var bO=function bO(){bP.imageRendering=false;bN()};this.imageRendering={abort:function bR(){f(bQ,aQ,bO)}};bk(bQ,aQ,bO,{once:true})}else{bN()}}},resetImage:function ah(){if(this.viewing||this.viewed){var bN=this.image;if(this.viewing){this.viewing.abort()}bN.parentNode.removeChild(bN);this.image=null}}};var bE={bind:function aK(){var bP=this.options,bQ=this.viewer,bO=this.canvas;var bN=this.element.ownerDocument;bk(bQ,s,this.onClick=this.click.bind(this));bk(bQ,aF,this.onWheel=this.wheel.bind(this),{passive:false,capture:true});bk(bQ,I,this.onDragStart=this.dragstart.bind(this));bk(bO,bl,this.onPointerDown=this.pointerdown.bind(this));bk(bN,br,this.onPointerMove=this.pointermove.bind(this));bk(bN,bC,this.onPointerUp=this.pointerup.bind(this));bk(bN,a,this.onKeyDown=this.keydown.bind(this));bk(window,ar,this.onResize=this.resize.bind(this));if(bP.toggleOnDblclick){bk(bO,bB,this.onDblclick=this.dblclick.bind(this))}},unbind:function bc(){var bP=this.options,bQ=this.viewer,bO=this.canvas;var bN=this.element.ownerDocument;f(bQ,s,this.onClick);f(bQ,aF,this.onWheel,{passive:false,capture:true});f(bQ,I,this.onDragStart);f(bO,bl,this.onPointerDown);f(bN,br,this.onPointerMove);f(bN,bC,this.onPointerUp);f(bN,a,this.onKeyDown);f(window,ar,this.onResize);if(bP.toggleOnDblclick){f(bO,bB,this.onDblclick)}}};var aT={click:function a3(bO){var bQ=bO.target;var bN=this.options,bR=this.imageData;var bP=a5(bQ,bg);if(H&&bO.isTrusted&&bQ===this.canvas){clearTimeout(this.clickCanvasTimeout)}switch(bP){case"mix":if(this.played){this.stop()}else{if(bN.inline){if(this.fulled){this.exit()}else{this.full()}}else{this.hide()}}break;case"hide":this.hide();break;case"view":this.view(a5(bQ,"index"));break;case"zoom-in":this.zoom(0.1,true);break;case"zoom-out":this.zoom(-0.1,true);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev(bN.loop);break;case"play":this.play(bN.fullscreen);break;case"next":this.next(bN.loop);break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-bR.scaleX||-1);break;case"flip-vertical":this.scaleY(-bR.scaleY||-1);break;default:if(this.played){this.stop()}}},dblclick:function aa(bN){bN.preventDefault();if(this.viewed&&bN.target===this.image){if(H&&bN.isTrusted){clearTimeout(this.doubleClickImageTimeout)}this.toggle()}},load:function bd(){var bS=this;if(this.timeout){clearTimeout(this.timeout);this.timeout=false}var bP=this.element,bO=this.options,bQ=this.image,bN=this.index,bR=this.viewerData;aU(bQ,ab);if(bO.loading){aU(this.canvas,bi)}bQ.style.cssText="height:0;"+"margin-left:".concat(bR.width/2,"px;")+"margin-top:".concat(bR.height/2,"px;")+"max-width:none!important;position:absolute;width:0;";this.initImage(function(){aS(bQ,bL,bO.movable);aS(bQ,bp,bO.transition);bS.renderImage(function(){bS.viewed=true;bS.viewing=false;if(j(bO.viewed)){bk(bP,bD,bO.viewed,{once:true})}aL(bP,bD,{originalImage:bS.images[bN],index:bN,image:bQ})})})},loadImage:function u(bQ){var bS=bQ.target;var bP=bS.parentNode;var bO=bP.offsetWidth||30;var bN=bP.offsetHeight||50;var bR=!!a5(bS,"filled");aX(bS,function(bU,bX){var bW=bU/bX;var bV=bO;var bT=bN;if(bN*bW>bO){if(bR){bV=bN*bW}else{bT=bO/bW}}else{if(bR){bT=bO/bW}else{bV=bN*bW}}M(bS,W({width:bV,height:bT},E({translateX:(bO-bV)/2,translateY:(bN-bT)/2})))})},keydown:function a6(bO){var bN=this.options;if(!this.fulled||!bN.keyboard){return}switch(bO.keyCode||bO.which||bO.charCode){case 27:if(this.played){this.stop()}else{if(bN.inline){if(this.fulled){this.exit()}}else{this.hide()}}break;case 32:if(this.played){this.stop()}break;case 37:this.prev(bN.loop);break;case 38:bO.preventDefault();this.zoom(bN.zoomRatio,true);break;case 39:this.next(bN.loop);break;case 40:bO.preventDefault();this.zoom(-bN.zoomRatio,true);break;case 48:case 49:if(bO.ctrlKey){bO.preventDefault();this.toggle()}break;default:}},dragstart:function b(bN){if(bN.target.tagName.toLowerCase()==="img"){bN.preventDefault()}},pointerdown:function al(bR){var bO=this.options,bN=this.pointers;var bQ=bR.buttons,bP=bR.button;if(!this.viewed||this.showing||this.viewing||this.hiding||V(bQ)&&bQ!==1||V(bP)&&bP!==0||bR.ctrlKey){return}bR.preventDefault();if(bR.changedTouches){ag(bR.changedTouches,function(bT){bN[bT.identifier]=au(bT)})}else{bN[bR.pointerId||0]=au(bR)}var bS=bO.movable?bw:false;if(Object.keys(bN).length>1){bS=y}else{if((bR.pointerType==="touch"||bR.type==="touchstart")&&this.isSwitchable()){bS=aj}}if(bO.transition&&(bS===bw||bS===y)){aU(this.image,bp)}this.action=bS},pointermove:function ax(bO){var bN=this.pointers,bP=this.action;if(!this.viewed||!bP){return}bO.preventDefault();if(bO.changedTouches){ag(bO.changedTouches,function(bQ){W(bN[bQ.identifier]||{},au(bQ,true))})}else{W(bN[bO.pointerId||0]||{},au(bO,true))}this.change(bO)},pointerup:function x(bQ){var bP=this;var bO=this.options,bR=this.action,bN=this.pointers;var bS;if(bQ.changedTouches){ag(bQ.changedTouches,function(bT){bS=bN[bT.identifier];delete bN[bT.identifier]})}else{bS=bN[bQ.pointerId||0];delete bN[bQ.pointerId||0]}if(!bR){return}bQ.preventDefault();if(bO.transition&&(bR===bw||bR===y)){q(this.image,bp)}this.action=false;if(H&&bR!==y&&bS&&Date.now()-bS.timeStamp<500){clearTimeout(this.clickCanvasTimeout);clearTimeout(this.doubleClickImageTimeout);if(bO.toggleOnDblclick&&this.viewed&&bQ.target===this.image){if(this.imageClicked){this.imageClicked=false;this.doubleClickImageTimeout=setTimeout(function(){aL(bP.image,bB)},50)}else{this.imageClicked=true;this.doubleClickImageTimeout=setTimeout(function(){bP.imageClicked=false},500)}}else{this.imageClicked=false;if(bO.backdrop&&bO.backdrop!=="static"&&bQ.target===this.canvas){this.clickCanvasTimeout=setTimeout(function(){aL(bP.canvas,s)},50)}}}},resize:function v(){var bN=this;if(!this.isShown||this.hiding){return}this.initContainer();this.initViewer();this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){bN.renderImage()})}if(this.played){if(this.options.fullscreen&&this.fulled&&!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)){this.stop();return}ag(this.player.getElementsByTagName("img"),function(bO){bk(bO,aC,bN.loadImage.bind(bN),{once:true});aL(bO,aC)})}},wheel:function g(bP){var bN=this;if(!this.viewed){return}bP.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(function(){bN.wheeling=false},50);var bO=Number(this.options.zoomRatio)||0.1;var bQ=1;if(bP.deltaY){bQ=bP.deltaY>0?1:-1}else{if(bP.wheelDelta){bQ=-bP.wheelDelta/120}else{if(bP.detail){bQ=bP.detail>0?1:-1}}}this.zoom(-bQ*bO,true,bP)}};var aq={show:function aW(){var bN=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bP=this.element,bO=this.options;if(bO.inline||this.showing||this.isShown||this.showing){return this}if(!this.ready){this.build();if(this.ready){this.show(bN)}return this}if(j(bO.show)){bk(bP,ai,bO.show,{once:true})}if(aL(bP,ai)===false||!this.ready){return this}if(this.hiding){this.transitioning.abort()}this.showing=true;this.open();var bR=this.viewer;aU(bR,ac);if(bO.transition&&!bN){var bQ=this.shown.bind(this);this.transitioning={abort:function bS(){f(bR,aQ,bQ);aU(bR,J)}};q(bR,bp);bR.offsetWidth;bk(bR,aQ,bQ,{once:true});q(bR,J)}else{q(bR,J);this.shown()}return this},hide:function a2(){var bN=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bQ=this.element,bO=this.options;if(bO.inline||this.hiding||!(this.isShown||this.showing)){return this}if(j(bO.hide)){bk(bQ,at,bO.hide,{once:true})}if(aL(bQ,at)===false){return this}if(this.showing){this.transitioning.abort()}this.hiding=true;if(this.played){this.stop()}else{if(this.viewing){this.viewing.abort()}}var bS=this.viewer;if(bO.transition&&!bN){var bR=this.hidden.bind(this);var bP=function bP(){setTimeout(function(){bk(bS,aQ,bR,{once:true});aU(bS,J)},0)};this.transitioning={abort:function bT(){if(this.viewed){f(this.image,aQ,bP)}else{f(bS,aQ,bR)}}};if(this.viewed&&r(this.image,bp)){bk(this.image,aQ,bP,{once:true});this.zoomTo(0,false,false,true)}else{bP()}}else{aU(bS,J);this.hidden()}return this},view:function aN(){var bU=this;var bV=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.options.initialViewIndex;bV=Number(bV)||0;if(!this.isShown){this.index=bV;return this.show()}if(this.hiding||this.played||bV<0||bV>=this.length||this.viewed&&bV===this.index){return this}if(this.viewing){this.viewing.abort()}var bR=this.element,b0=this.options,bX=this.title,bO=this.canvas;var bZ=this.items[bV];var bS=bZ.querySelector("img");var bN=a5(bS,"originalUrl");var bT=K(bS.getAttribute("alt"));var bP=document.createElement("img");bP.src=bN;bP.alt=bT;if(j(b0.view)){bk(bR,Z,b0.view,{once:true})}if(aL(bR,Z,{originalImage:this.images[bV],index:bV,image:bP})===false||!this.isShown||this.hiding||this.played){return this}this.image=bP;aU(this.items[this.index],ay);q(bZ,ay);this.viewed=false;this.index=bV;this.imageData={};q(bP,ab);if(b0.loading){q(bO,bi)}bO.innerHTML="";bO.appendChild(bP);this.renderList();bX.innerHTML="";var bY=function bY(){var b2=bU.imageData;var b1=Array.isArray(b0.title)?b0.title[1]:b0.title;bX.innerHTML=K(j(b1)?b1.call(bU,bP,b2,bU.images[bV]):"".concat(bT," (").concat(b2.naturalWidth," \xD7 ").concat(b2.naturalHeight,")"))};var bW;bk(bR,bD,bY,{once:true});this.viewing={abort:function bQ(){f(bR,bD,bY);if(bP.complete){if(this.imageRendering){this.imageRendering.abort()}else{if(this.imageInitializing){this.imageInitializing.abort()}}}else{bP.src="";f(bP,aC,bW);if(this.timeout){clearTimeout(this.timeout)}}}};if(bP.complete){this.load()}else{bk(bP,aC,bW=this.load.bind(this),{once:true});if(this.timeout){clearTimeout(this.timeout)}this.timeout=setTimeout(function(){aU(bP,ab);bU.timeout=false},1000)}return this},prev:function a8(){var bN=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bO=this.index-1;if(bO<0){bO=bN?this.length-1:0}this.view(bO);return this},next:function X(){var bN=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bP=this.length-1;var bO=this.index+1;if(bO>bP){bO=bN?0:bP}this.view(bO);return this},move:function F(bN,bP){var bO=this.imageData;this.moveTo(aJ(bN)?bN:bO.left+Number(bN),aJ(bP)?bP:bO.top+Number(bP));return this},moveTo:function bq(bN){var bQ=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bN;var bP=this.imageData;bN=Number(bN);bQ=Number(bQ);if(this.viewed&&!this.played&&this.options.movable){var bO=false;if(V(bN)){bP.left=bN;bO=true}if(V(bQ)){bP.top=bQ;bO=true}if(bO){this.renderImage()}}return this},zoom:function aR(bP){var bO=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var bN=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var bQ=this.imageData;bP=Number(bP);if(bP<0){bP=1/(1-bP)}else{bP=1+bP}this.zoomTo(bQ.width*bP/bQ.naturalWidth,bO,bN);return this},zoomTo:function aM(bW){var b8=this;var bY=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var b5=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var b3=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var bO=this.element,bS=this.options,b0=this.pointers,b9=this.imageData;var b6=b9.width,b2=b9.height,bT=b9.left,b1=b9.top,bQ=b9.naturalWidth,bP=b9.naturalHeight;bW=Math.max(0,bW);if(V(bW)&&this.viewed&&!this.played&&(b3||bS.zoomable)){if(!b3){var bX=Math.max(0.01,bS.minZoomRatio);var bN=Math.min(100,bS.maxZoomRatio);bW=Math.min(Math.max(bW,bX),bN)}if(b5&&bW>0.95&&bW<1.05){bW=1}var bZ=bQ*bW;var b7=bP*bW;var b4=bZ-b6;var bR=b7-b2;var bU=b6/bQ;if(j(bS.zoom)){bk(bO,af,bS.zoom,{once:true})}if(aL(bO,af,{ratio:bW,oldRatio:bU,originalEvent:b5})===false){return this}this.zooming=true;if(b5){var bV=bI(this.viewer);var ca=b0&&Object.keys(b0).length?bj(b0):{pageX:b5.pageX,pageY:b5.pageY};b9.left-=b4*((ca.pageX-bV.left-bT)/b6);b9.top-=bR*((ca.pageY-bV.top-b1)/b2)}else{b9.left-=b4/2;b9.top-=bR/2}b9.width=bZ;b9.height=b7;b9.ratio=bW;this.renderImage(function(){b8.zooming=false;if(j(bS.zoomed)){bk(bO,az,bS.zoomed,{once:true})}aL(bO,az,{ratio:bW,oldRatio:bU,originalEvent:b5})});if(bY){this.tooltip()}}return this},rotate:function m(bN){this.rotateTo((this.imageData.rotate||0)+Number(bN));return this},rotateTo:function bM(bN){var bO=this.imageData;bN=Number(bN);if(V(bN)&&this.viewed&&!this.played&&this.options.rotatable){bO.rotate=bN;this.renderImage()}return this},scaleX:function P(bN){this.scale(bN,this.imageData.scaleY);return this},scaleY:function O(bN){this.scale(this.imageData.scaleX,bN);return this},scale:function aO(bO){var bN=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bO;var bQ=this.imageData;bO=Number(bO);bN=Number(bN);if(this.viewed&&!this.played&&this.options.scalable){var bP=false;if(V(bO)){bQ.scaleX=bO;bP=true}if(V(bN)){bQ.scaleY=bN;bP=true}if(bP){this.renderImage()}}return this},play:function i(){var bO=this;var bT=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.isShown||this.played){return this}var bV=this.options,bU=this.player;var bR=this.loadImage.bind(this);var bQ=[];var bS=0;var bP=0;this.played=true;this.onLoadWhenPlay=bR;if(bT){this.requestFullscreen()}q(bU,T);ag(this.items,function(bY,bX){var bW=bY.querySelector("img");var bZ=document.createElement("img");bZ.src=a5(bW,"originalUrl");bZ.alt=K(bW.getAttribute("alt"));bS+=1;q(bZ,c);aS(bZ,bp,bV.transition);if(r(bY,ay)){q(bZ,J);bP=bX}bQ.push(bZ);bk(bZ,aC,bR,{once:true});bU.appendChild(bZ)});if(V(bV.interval)&&bV.interval>0){var bN=function bN(){bO.playing=setTimeout(function(){aU(bQ[bP],J);bP+=1;bP=bP<bS?bP:0;q(bQ[bP],J);bN()},bV.interval)};if(bS>1){bN()}}return this},stop:function aG(){var bO=this;if(!this.played){return this}var bN=this.player;this.played=false;clearTimeout(this.playing);ag(bN.getElementsByTagName("img"),function(bP){f(bP,aC,bO.onLoadWhenPlay)});aU(bN,T);bN.innerHTML="";this.exitFullscreen();return this},full:function av(){var bO=this;var bN=this.options,bR=this.viewer,bQ=this.image,bP=this.list;if(!this.isShown||this.played||this.fulled||!bN.inline){return this}this.fulled=true;this.open();q(this.button,bn);if(bN.transition){aU(bP,bp);if(this.viewed){aU(bQ,bp)}}q(bR,bH);bR.setAttribute("style","");M(bR,{zIndex:bN.zIndex});this.initContainer();this.viewerData=W({},this.containerData);this.renderList();if(this.viewed){this.initImage(function(){bO.renderImage(function(){if(bN.transition){setTimeout(function(){q(bQ,bp);q(bP,bp)},0)}})})}return this},exit:function bK(){var bN=this;var bO=this.options,bR=this.viewer,bQ=this.image,bP=this.list;if(!this.isShown||this.played||!this.fulled||!bO.inline){return this}this.fulled=false;this.close();aU(this.button,bn);if(bO.transition){aU(bP,bp);if(this.viewed){aU(bQ,bp)}}aU(bR,bH);M(bR,{zIndex:bO.zIndexInline});this.viewerData=W({},this.parentData);this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){bN.renderImage(function(){if(bO.transition){setTimeout(function(){q(bQ,bp);q(bP,bp)},0)}})})}return this},tooltip:function w(){var bN=this;var bP=this.options,bO=this.tooltipBox,bQ=this.imageData;if(!this.viewed||this.played||!bP.tooltip){return this}bO.textContent="".concat(Math.round(bQ.ratio*100),"%");if(!this.tooltipping){if(bP.transition){if(this.fading){aL(bO,aQ)}q(bO,T);q(bO,c);q(bO,bp);bO.offsetWidth;q(bO,J)}else{q(bO,T)}}else{clearTimeout(this.tooltipping)}this.tooltipping=setTimeout(function(){if(bP.transition){bk(bO,aQ,function(){aU(bO,T);aU(bO,c);aU(bO,bp);bN.fading=false},{once:true});aU(bO,J);bN.fading=true}else{aU(bO,T)}bN.tooltipping=false},1000);return this},toggle:function am(){if(this.imageData.ratio===1){this.zoomTo(this.initialImageData.ratio,true)}else{this.zoomTo(1,true)}return this},reset:function a1(){if(this.viewed&&!this.played){this.imageData=W({},this.initialImageData);this.renderImage()}return this},update:function p(){var bR=this.element,bQ=this.options,bS=this.isImg;if(bS&&!bR.parentNode){return this.destroy()}var bN=[];ag(bS?[bR]:bR.querySelectorAll("img"),function(bT){if(bQ.filter){if(bQ.filter(bT)){bN.push(bT)}}else{bN.push(bT)}});if(!bN.length){return this}this.images=bN;this.length=bN.length;if(this.ready){var bP=[];ag(this.items,function(bV,bU){var bT=bV.querySelector("img");var bW=bN[bU];if(bW){if(bW.src!==bT.src){bP.push(bU)}}else{bP.push(bU)}});M(this.list,{width:"auto"});this.initList();if(this.isShown){if(this.length){if(this.viewed){var bO=bP.indexOf(this.index);if(bO>=0){this.viewed=false;this.view(Math.max(this.index-(bO+1),0))}else{q(this.items[this.index],ay)}}}else{this.image=null;this.viewed=false;this.index=0;this.imageData={};this.canvas.innerHTML="";this.title.innerHTML=""}}}else{this.build()}return this},destroy:function l(){var bO=this.element,bN=this.options;if(!bO[G]){return this}this.destroyed=true;if(this.ready){if(this.played){this.stop()}if(bN.inline){if(this.fulled){this.exit()}this.unbind()}else{if(this.isShown){if(this.viewing){if(this.imageRendering){this.imageRendering.abort()}else{if(this.imageInitializing){this.imageInitializing.abort()}}}if(this.hiding){this.transitioning.abort()}this.hidden()}else{if(this.showing){this.transitioning.abort();this.hidden()}}}this.ready=false;this.viewer.parentNode.removeChild(this.viewer)}else{if(bN.inline){if(this.delaying){this.delaying.abort()}else{if(this.initializing){this.initializing.abort()}}}}if(!bN.inline){f(bO,s,this.onStart)}bO[G]=undefined;return this}};var ap={open:function aD(){var bN=this.body;q(bN,A);bN.style.paddingRight="".concat(this.scrollbarWidth+(parseFloat(this.initialBodyPaddingRight)||0),"px")},close:function Y(){var bN=this.body;aU(bN,A);bN.style.paddingRight=this.initialBodyPaddingRight},shown:function aV(){var bO=this.element,bN=this.options;this.fulled=true;this.isShown=true;this.render();this.bind();this.showing=false;if(j(bN.shown)){bk(bO,k,bN.shown,{once:true})}if(aL(bO,k)===false){return}if(this.ready&&this.isShown&&!this.hiding){this.view(this.index)}},hidden:function ao(){var bO=this.element,bN=this.options;this.fulled=false;this.viewed=false;this.isShown=false;this.close();this.unbind();q(this.viewer,ac);this.resetList();this.resetImage();this.hiding=false;if(!this.destroyed){if(j(bN.hidden)){bk(bO,a9,bN.hidden,{once:true})}aL(bO,a9)}},requestFullscreen:function U(){var bN=this.element.ownerDocument;if(this.fulled&&!(bN.fullscreenElement||bN.webkitFullscreenElement||bN.mozFullScreenElement||bN.msFullscreenElement)){var bO=bN.documentElement;if(bO.requestFullscreen){bO.requestFullscreen()}else{if(bO.webkitRequestFullscreen){bO.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}else{if(bO.mozRequestFullScreen){bO.mozRequestFullScreen()}else{if(bO.msRequestFullscreen){bO.msRequestFullscreen()}}}}}},exitFullscreen:function t(){var bN=this.element.ownerDocument;if(this.fulled&&(bN.fullscreenElement||bN.webkitFullscreenElement||bN.mozFullScreenElement||bN.msFullscreenElement)){if(bN.exitFullscreen){bN.exitFullscreen()}else{if(bN.webkitExitFullscreen){bN.webkitExitFullscreen()}else{if(bN.mozCancelFullScreen){bN.mozCancelFullScreen()}else{if(bN.msExitFullscreen){bN.msExitFullscreen()}}}}}},change:function aI(bR){var bP=this.options,bO=this.pointers;var bS=bO[Object.keys(bO)[0]];var bN=bS.endX-bS.startX;var bT=bS.endY-bS.startY;switch(this.action){case bw:this.move(bN,bT);break;case y:this.zoom(a4(bO),false,bR);break;case aj:this.action="switched";var bQ=Math.abs(bN);if(bQ>1&&bQ>Math.abs(bT)){this.pointers={};if(bN>1){this.prev(bP.loop)}else{if(bN<-1){this.next(bP.loop)}}}break;default:}ag(bO,function(bU){bU.startX=bU.endX;bU.startY=bU.endY})},isSwitchable:function bu(){var bO=this.imageData,bN=this.viewerData;return this.length>1&&bO.left>=0&&bO.top>=0&&bO.width<=bN.width&&bO.height<=bN.height}};var aP=an.Viewer;var S=function(){function bO(bT){var bS=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};aw(this,bO);if(!bT||bT.nodeType!==1){throw new Error("The first argument is required and must be an element.")}this.element=bT;this.options=W({},N,o(bS)&&bS);this.action=false;this.fading=false;this.fulled=false;this.hiding=false;this.imageClicked=false;this.imageData={};this.index=this.options.initialViewIndex;this.isImg=false;this.isShown=false;this.length=0;this.played=false;this.playing=false;this.pointers={};this.ready=false;this.showing=false;this.timeout=false;this.tooltipping=false;this.viewed=false;this.viewing=false;this.wheeling=false;this.zooming=false;this.init()}aZ(bO,[{key:"init",value:function bQ(){var bX=this;var bV=this.element,b0=this.options;if(bV[G]){return}bV[G]=this;var bT=bV.tagName.toLowerCase()==="img";var bZ=[];ag(bT?[bV]:bV.querySelectorAll("img[src]"),function(b2){if(j(b0.filter)){if(b0.filter.call(bX,b2)){bZ.push(b2)}}else{bZ.push(b2)}});this.isImg=bT;this.length=bZ.length;this.images=bZ;var b1=bV.ownerDocument;var bW=b1.body||b1.documentElement;this.body=bW;this.scrollbarWidth=window.innerWidth-b1.documentElement.clientWidth;this.initialBodyPaddingRight=window.getComputedStyle(bW).paddingRight;if(aJ(document.createElement(G).style.transition)){b0.transition=false}if(b0.inline){var bY=0;var bS=function bS(){bY+=1;if(bY===bX.length){var b2;bX.initializing=false;bX.delaying={abort:function b3(){clearTimeout(b2)}};b2=setTimeout(function(){bX.delaying=false;bX.build()},0)}};this.initializing={abort:function bU(){ag(bZ,function(b2){if(!b2.complete){f(b2,aC,bS)}})}};ag(bZ,function(b2){if(b2.complete){bS()}else{bk(b2,aC,bS,{once:true})}})}else{bk(bV,s,this.onStart=function(b2){var b3=b2.target;if(b3.tagName.toLowerCase()==="img"&&(!j(b0.filter)||b0.filter.call(bX,b3))){bX.view(bX.images.indexOf(b3))}})}}},{key:"build",value:function bP(){if(this.ready){return}var bU=this.element,bY=this.options;var b0=bU.parentNode;var b8=document.createElement("div");b8.innerHTML=ae;var bV=b8.querySelector(".".concat(G,"-container"));var b9=bV.querySelector(".".concat(G,"-title"));var b2=bV.querySelector(".".concat(G,"-toolbar"));var b4=bV.querySelector(".".concat(G,"-navbar"));var bS=bV.querySelector(".".concat(G,"-button"));var bX=bV.querySelector(".".concat(G,"-canvas"));this.parent=b0;this.viewer=bV;this.title=b9;this.toolbar=b2;this.navbar=b4;this.button=bS;this.canvas=bX;this.footer=bV.querySelector(".".concat(G,"-footer"));this.tooltipBox=bV.querySelector(".".concat(G,"-tooltip"));this.player=bV.querySelector(".".concat(G,"-player"));this.list=bV.querySelector(".".concat(G,"-list"));q(b9,!bY.title?ac:R(Array.isArray(bY.title)?bY.title[0]:bY.title));q(b4,!bY.navbar?ac:R(bY.navbar));aS(bS,ac,!bY.button);if(bY.backdrop){q(bV,"".concat(G,"-backdrop"));if(!bY.inline&&bY.backdrop!=="static"){ak(bX,bg,"hide")}}if(bf(bY.className)&&bY.className){bY.className.split(B).forEach(function(ca){q(bV,ca)})}if(bY.toolbar){var b5=document.createElement("ul");var bT=o(bY.toolbar);var b7=n.slice(0,3);var bW=n.slice(5,6);var bZ=n.slice(7,9);var b3=n.slice(9);if(!bT){q(b2,R(bY.toolbar))}ag(bT?bY.toolbar:n,function(cd,cb){var cf=bT&&o(cd);var ca=bT?bs(cb):cd;var ce=cf&&!aJ(cd.show)?cd.show:cd;if(!ce||!bY.zoomable&&b7.indexOf(ca)!==-1||!bY.rotatable&&bZ.indexOf(ca)!==-1||!bY.scalable&&b3.indexOf(ca)!==-1||!bY.playable&&bW.indexOf(ca)!==-1){return}var ci=cf&&!aJ(cd.size)?cd.size:cd;var ch=cf&&!aJ(cd.click)?cd.click:cd;var cb=n.indexOf(ca);var cc=ca;if(cb!=-1){cc=bb[cb]}var cg=document.createElement("li");cg.setAttribute("role","button");cg.setAttribute("title",cc);q(cg,"".concat(G,"-").concat(ca));if(!j(ch)){ak(cg,bg,ca)}if(V(ce)){q(cg,R(ce))}if(["small","large"].indexOf(ci)!==-1){q(cg,"".concat(G,"-").concat(ci))}else{if(ca==="play"){q(cg,"".concat(G,"-large"))}}if(j(ch)){bk(cg,s,ch)}b5.appendChild(cg)});b2.appendChild(b5)}else{q(b2,ac)}if(!bY.rotatable){var b6=b2.querySelectorAll('li[class*="rotate"]');q(b6,ab);ag(b6,function(ca){b2.appendChild(ca)})}if(bY.inline){q(bS,bt);M(bV,{zIndex:bY.zIndexInline});if(window.getComputedStyle(b0).position==="static"){M(b0,{position:"relative"})}b0.insertBefore(bV,bU.nextSibling)}else{q(bS,bA);q(bV,bH);q(bV,c);q(bV,ac);M(bV,{zIndex:bY.zIndex});var b1=bY.container;if(bf(b1)){b1=bU.ownerDocument.querySelector(b1)}if(!b1){b1=this.body}b1.appendChild(bV)}if(bY.inline){this.render();this.bind();this.isShown=true}this.ready=true;if(j(bY.ready)){bk(bU,ad,bY.ready,{once:true})}if(aL(bU,ad)===false){this.ready=false;return}if(this.ready&&bY.inline){this.view(this.index)}}}],[{key:"noConflict",value:function bN(){window.Viewer=aP;return bO}},{key:"setDefaults",value:function bR(bS){W(N,o(bS)&&bS)}}]);return bO}();W(S.prototype,Q,bE,aT,aq,ap);return S}));